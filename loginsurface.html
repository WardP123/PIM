<!DOCTYPE html>
<html>
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <style>
        .second, .third {
            display: none;
        }
    </style>
    <script>
		window.getCookie = function(name) {
		  var match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
		  if (match) return match[2];
		}
        function showUsername() {
				var x = document.getElementById("username");
            	var y = document.getElementById("groupButton");
            	x.style.display = "block";
            	y.style.display = "none";
			}

        function check_gameid() {
        	var gameid = document.getElementById("group").value;
            $.ajax({
                url: "http://84.28.82.98:8081/check_gameid",
                type: 'POST',
				data: JSON.stringify({ gameid: gameid}),
				contentType: "application/json; charset=utf-8",
				dataType: "json",
                async: true,
                success: function(result) {
					$.each(result, function(i, item){
					if (item == "yes" ){
						showUsername()
					}else{
						alert("Group number does not exist!")
					}
        		});
				},
        		error: function(data) {
					alert("foutje")
        			alert(data)
        			}
             });
		};
		function check_username() {
			var gameid_local = document.getElementById("group").value;
			var username_local = document.getElementById("usernameintext").value;
            $.ajax({
				
                url: "http://84.28.82.98:8081/check_username",
                type: 'POST',
				data: JSON.stringify({"gameid": gameid_local, "username": username_local}),
				contentType: "application/json; charset=utf-8",
				dataType: "json",
                async: true,
                success: function(result) {
					if (result.gamenumber_exists == "no" ){
						alert("Gamenumber does not exist!");
						
					}else{
						if (result.username_exists == "no"){
							showPassword();
						} else {
						alert("Username already exists!");
						}
					}
				},
        		error: function(data) {
					alert("foutje")
        			}
             });

        }
		function create_account() {
			var gameid_local = document.getElementById("group").value;
			var username_local = document.getElementById("usernameintext").value;
			var pin_local = document.getElementById("pinintext").value;
            $.ajax({
                url: "http://84.28.82.98:8081/login",
                type: 'POST',
				data: JSON.stringify({"gameid": gameid_local, "username": username_local, "pin": pin_local}),
				contentType: "application/json; charset=utf-8",
				dataType: "json",
                async: true,
                success: function(result) {
					document.cookie = ("account="+result);
					window.location.href = "rules.html";
				},
        		error: function(data) {
					alert("foutje")
        			}
             });
        }
        function showPassword() {
            var x = document.getElementById("password");
            var y = document.getElementById("userButton");
            x.style.display = "block";
            y.style.display = "none";
        }

    </script>
</head>
<body>
    <p>
        Welecome please enter your group number
    </p>
    <form>
        Group Number <br>
        <input type="text" id="group"> <br>
        <input type="button" id="groupButton" value="Submit" onclick="check_gameid()">
    </form>
    <form class="second" id="username">
        Username: <br>
        <input type="text" id="usernameintext"> <br>
        <input type="button" id="userButton" value="Submit" onclick="check_username()">
    </form>
    <form class="third" id="password">
        PIN: <br>
        <input type="password" id="pinintext"> <br>
        <input type="button" value="Submit" onclick="create_account()">
    </form>
</body>
<!-- gameid - username - pin  -->
<!-- post  -->

</html>
